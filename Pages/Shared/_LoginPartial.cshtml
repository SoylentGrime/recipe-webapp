@inject Recipe_Webpage.Services.ILocalizationService L
@* Language Selector and Edit Mode Toggle - No login required *@
<ul class="navbar-nav d-flex flex-row align-items-center">
    <li class="nav-item me-2">
        <button type="button" class="btn btn-sm btn-outline-light" onclick="toggleLanguage()" title="@(L.IsChinese ? "Switch to English" : "切换到中文")">
            <i class="bi bi-globe"></i> @(L.IsChinese ? "中文" : "EN")
        </button>
    </li>
    <li class="nav-item">
        <button type="button" class="btn btn-sm nav-link" id="editModeToggle" onclick="toggleEditMode()">
            <i class="bi bi-pencil-square"></i> <span id="editModeText">@L["EditMode"]</span>
        </button>
    </li>
</ul>

<script>
    var editModeText = '@L["EditMode"]';
    var exitEditModeText = '@L["ExitEditMode"]';
    var currentLang = '@L.CurrentCulture';
    
    function toggleLanguage() {
        const newLang = currentLang === 'zh' ? 'en' : 'zh';
        localStorage.setItem('preferredLanguage', newLang);
        const url = new URL(window.location.href);
        url.searchParams.set('lang', newLang);
        window.location.href = url.toString();
    }
    
    function isEditMode() {
        return localStorage.getItem('editMode') === 'true';
    }

    function toggleEditMode() {
        const currentMode = isEditMode();
        localStorage.setItem('editMode', !currentMode);
        updateEditModeUI();
        location.reload();
    }

    function updateEditModeUI() {
        const editMode = isEditMode();
        const toggle = document.getElementById('editModeToggle');
        const text = document.getElementById('editModeText');
        
        if (editMode) {
            toggle.classList.add('btn-warning');
            toggle.classList.remove('btn-outline-secondary');
            text.textContent = exitEditModeText;
        } else {
            toggle.classList.remove('btn-warning');
            toggle.classList.add('btn-outline-secondary');
            text.textContent = editModeText;
        }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', updateEditModeUI);
</script>
